plugins {
	id 'org.asciidoctor.jvm.convert' version '3.1.0'
}


apply plugin: "io.github.gradle-nexus.publish-plugin"

configure(allprojects) {
	group = "io.github.jcohy"
	version = "3.0.0.0"
}


nexusPublishing {
	repositories {
		sonatype {
			username = System.getenv("NEXUS_OSS_USER_NAME")
			password = System.getenv("NEXUS_OSS_PASS_WORD")
		}
	}
}

asciidoctor {
	baseDirFollowsSourceDir()
	options doctype: 'book'
	attributes(
			'idprefix' : '',
			'idseparator':'-',
			'toc':'left',
			'toclevels':4,
			'tabsize':4,
			'icons':'font',
			'source-indent':0,
			'docinfo':'shared,private',
	)
	configurations "asciidoctorExtensions"
	sourceDir "src/docs/asciidoc"
	sources {
		include '*.adoc'
	}
	outputOptions {
		backends "spring-html"
	}

	resources {
		from(sourceDir) {
			include 'img/**'
		}
	}
	doLast {
		delete(file(buildDir.path + '/docs/asciidoc/img/banner-logo.svg'))
		copy {
			from file(projectDir.path + '/src/docs/asciidoc/img/banner-logo.svg')
			into file(buildDir.path + "/docs/asciidoc//img")
		}
	}
}